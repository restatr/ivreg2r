% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit-2sls.R
\name{.fit_2sls}
\alias{.fit_2sls}
\title{Fit 2SLS via two calls to lm.fit / lm.wfit}
\usage{
.fit_2sls(parsed, small = FALSE, dofminus = 0L, sdofminus = 0L)
}
\arguments{
\item{parsed}{A \code{parsed_formula} object from \code{.parse_formula()}.}

\item{small}{Logical: if \code{TRUE}, use \code{N-K} denominator for sigma;
if \code{FALSE}, use \code{N}.}

\item{dofminus}{Integer: large-sample DoF adjustment (default 0).}

\item{sdofminus}{Integer: small-sample DoF adjustment (default 0).}
}
\value{
A named list with: \code{coefficients}, \code{residuals}, \code{fitted.values},
\code{vcov}, \code{sigma}, \code{df.residual}, \code{rank}, \code{r.squared}, \code{adj.r.squared},
\code{rss}, \code{bread}, \code{X_hat}.
}
\description{
Stage 1 projects regressors X onto the instrument space Z.
Stage 2 regresses y on the projected regressors X_hat.
Residuals and fitted values use the \emph{original} X, not X_hat.
}
\details{
When weights are present, uses \code{\link[=lm.wfit]{lm.wfit()}} for both stages. \code{lm.wfit}
returns fitted values on the original (unweighted) scale and a QR of
the weighted design matrix, so the bread is \verb{(X_hat'WX_hat)^\{-1\}}.
}
\keyword{internal}
