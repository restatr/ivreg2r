% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnostics-overid.R
\name{.compute_stock_wright}
\alias{.compute_stock_wright}
\title{Stock-Wright LM S statistic}
\usage{
.compute_stock_wright(
  Z,
  X,
  y,
  weights,
  cluster_vec,
  vcov_type,
  N,
  K1,
  L1,
  endo_names,
  dofminus = 0L,
  weight_type = "aweight",
  kernel = NULL,
  bw = NULL,
  time_index = NULL
)
}
\arguments{
\item{Z}{N x L instrument matrix.}

\item{X}{N x K regressor matrix.}

\item{y}{N x 1 response vector.}

\item{weights}{Normalized weights (sum to N), or NULL.}

\item{cluster_vec}{Cluster membership vector, or NULL.}

\item{vcov_type}{Character: \code{"iid"}, \code{"HC0"}, \code{"HC1"}, or \code{"CL"}.}

\item{N}{Number of observations.}

\item{K1}{Number of endogenous regressors.}

\item{L1}{Number of excluded instruments.}

\item{endo_names}{Character vector of endogenous variable names.}

\item{dofminus}{Integer: large-sample DoF adjustment (default 0).}
}
\value{
Named list with \code{stat}, \code{p}, \code{df}.
}
\description{
Weak-instrument-robust LM test of H0: all endogenous coefficients = 0
and orthogonality conditions are valid. This is the LM counterpart of
the Anderson-Rubin Wald test.
}
\details{
Unlike Sargan/Hansen J, the S statistic uses residuals from regressing
\code{y} on the included exogenous regressors only (constraining endogenous
coefficients to zero). For IID, a homoskedastic omega is used
(\verb{sigma^2 * Z'WZ / N}); for robust/cluster, the HC/CL omega is used.
}
\keyword{internal}
