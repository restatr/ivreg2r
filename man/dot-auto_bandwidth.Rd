% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kernel.R
\name{.auto_bandwidth}
\alias{.auto_bandwidth}
\title{Automatic bandwidth selection via Newey-West (1994)}
\usage{
.auto_bandwidth(resid, Z, time_index, kernel, has_intercept, N)
}
\arguments{
\item{resid}{N-vector of residuals (sorted by time).}

\item{Z}{N x L instrument matrix (sorted by time), including exogenous
regressors and (if present) the intercept column.}

\item{time_index}{List from \code{.build_time_index()}.}

\item{kernel}{Canonical kernel name (already validated as auto-compatible).}

\item{has_intercept}{Logical: whether the last column of Z is an intercept.
If TRUE, the intercept column is excluded from the score process
(Stata zeros it out via the \code{h} vector).}

\item{N}{Integer: number of observations (used as autocovariance
denominator, matching Stata's \code{nobs}).}
}
\value{
Numeric scalar: selected bandwidth (>= 1). Integer for
Bartlett/Parzen, possibly fractional for Quadratic Spectral.
}
\description{
Implements the Newey-West (1994, REStud 61(4):631-653) plug-in bandwidth
selector, matching Stata's \code{s_abw()} (ivreg2.ado:4796-4911). Supported
for Bartlett, Parzen, and Quadratic Spectral kernels only.
}
\keyword{internal}
