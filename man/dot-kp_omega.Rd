% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnostics-id.R
\name{.kp_omega}
\alias{.kp_omega}
\title{Kronecker score covariance for Kleibergen-Paap test}
\usage{
.kp_omega(
  Z1_perp,
  V_hat,
  weights,
  cluster_vec,
  N,
  K1,
  L1,
  weight_type = "aweight",
  kernel = NULL,
  bw = NULL,
  time_index = NULL
)
}
\arguments{
\item{Z1_perp}{N x L1 partialled excluded instruments.}

\item{V_hat}{N x K1 matrix (X1_perp for LM, residuals for Wald).}

\item{weights}{Normalized weights or NULL.}

\item{cluster_vec}{Cluster vector or NULL.}

\item{N}{Number of observations.}

\item{K1}{Number of endogenous regressors.}

\item{L1}{Number of excluded instruments.}
}
\value{
\verb{(K1*L1) x (K1*L1)} symmetric matrix.
}
\description{
Computes the \verb{(K1*L1) x (K1*L1)} score covariance matrix shat0.
For HC: shat0 = crossprod(scores) / N where row i of scores is
kron(V_hat_i, Z1_perp_i) for each observation i.
For cluster: same but with rowsum over clusters first.
}
\keyword{internal}
