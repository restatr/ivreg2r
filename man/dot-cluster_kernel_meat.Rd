% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vcov-hac.R
\name{.cluster_kernel_meat}
\alias{.cluster_kernel_meat}
\title{Compute cluster+kernel meat matrix (Driscoll-Kraay / Thompson time dimension)}
\usage{
.cluster_kernel_meat(
  basis,
  resid,
  time_index,
  kernel,
  bw,
  weights = NULL,
  weight_type = "aweight"
)
}
\arguments{
\item{basis}{N x P matrix (X_hat for VCV, Z for diagnostics). Must be
in sorted time order (matching \code{time_index}).}

\item{resid}{N-vector of residuals, in sorted time order.}

\item{time_index}{List from \code{.build_time_index()}.}

\item{kernel}{Canonical kernel name.}

\item{bw}{Numeric bandwidth.}

\item{weights}{Normalized weights (sorted) or NULL.}

\item{weight_type}{Character: \code{"aweight"} or \code{"pweight"}.}
}
\value{
P x P symmetric meat matrix (unscaled).
}
\description{
Aggregates observation-level scores by time period, then accumulates
kernel-weighted cross-lag products of time-clustered scores.
This is the time-dimension component used by both Driscoll-Kraay (DK)
and Thompson (two-way cluster+kernel) VCE.
}
\details{
Algorithm matches livreg2.do lines 444â€“535.
}
\keyword{internal}
