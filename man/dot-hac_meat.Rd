% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vcov-hac.R
\name{.hac_meat}
\alias{.hac_meat}
\title{Compute HAC meat matrix (heteroskedasticity and autocorrelation consistent)}
\usage{
.hac_meat(
  basis,
  resid,
  time_index,
  kernel,
  bw,
  weights = NULL,
  weight_type = "aweight"
)
}
\arguments{
\item{basis}{N x P matrix (X_hat for VCV, Z for diagnostics). Must be
in sorted time order (matching \code{time_index}).}

\item{resid}{N-vector of residuals, in sorted time order.}

\item{time_index}{List from \code{.build_time_index()}.}

\item{kernel}{Canonical kernel name (from \code{.validate_kernel()}).}

\item{bw}{Numeric bandwidth.}

\item{weights}{Normalized weights (sorted) or NULL.}

\item{weight_type}{Character: \code{"aweight"} or \code{"pweight"} (fweight blocked).}
}
\value{
P x P symmetric meat matrix (unscaled).
}
\description{
Returns the \strong{unscaled} P x P meat matrix. The caller divides by
\code{(N - dofminus)} to get the HAC omega (Stata livreg2.do line 326).
}
\keyword{internal}
