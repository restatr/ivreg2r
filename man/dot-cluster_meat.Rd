% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vcov-robust.R
\name{.cluster_meat}
\alias{.cluster_meat}
\title{Compute clustered meat matrix (one-way or two-way)}
\usage{
.cluster_meat(scores, cluster_vec)
}
\arguments{
\item{scores}{N x P score matrix (P = K for VCV, P = L for diagnostics).}

\item{cluster_vec}{Length-N vector (one-way) or list of 2 vectors (two-way)
of cluster identifiers.}
}
\value{
P x P symmetric meat matrix (unscaled).
}
\description{
Shared helper for the \code{rowsum() -> crossprod()} pattern used in VCV
computation and all diagnostic score covariance computations.
}
\details{
For one-way clustering, computes \code{crossprod(rowsum(scores, cluster_vec))}.
For two-way clustering (Cameron-Gelbach-Miller 2006), computes
\code{meat1 + meat2 - meat_intersection} where the intersection uses
\code{interaction(cv1, cv2, drop = TRUE)}.
}
\keyword{internal}
