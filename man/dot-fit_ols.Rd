% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit-ols.R
\name{.fit_ols}
\alias{.fit_ols}
\title{Fit OLS via lm.fit / lm.wfit (QR-based least squares)}
\usage{
.fit_ols(parsed, small = FALSE)
}
\arguments{
\item{parsed}{A \code{parsed_formula} object from \code{.parse_formula()}.}

\item{small}{Logical: if \code{TRUE}, use \code{N-K} denominator for sigma;
if \code{FALSE}, use \code{N}.}
}
\value{
A named list with: \code{coefficients}, \code{residuals}, \code{fitted.values},
\code{vcov}, \code{sigma}, \code{df.residual}, \code{rank}, \code{r.squared}, \code{adj.r.squared},
\code{rss}, \code{bread}.
}
\description{
When weights are present, uses \code{\link[=lm.wfit]{lm.wfit()}} which internally transforms by
\code{sqrt(w)} and returns unweighted residuals/fitted values with a QR of the
weighted design matrix. The bread is \verb{(X'WX)^\{-1\}} automatically.
}
\keyword{internal}
