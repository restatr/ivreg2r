% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnostics-endogeneity.R
\name{.compute_endogeneity_test}
\alias{.compute_endogeneity_test}
\title{Endogeneity test (C-statistic / difference-in-J)}
\usage{
.compute_endogeneity_test(
  Z,
  X,
  y,
  residuals,
  rss,
  weights,
  cluster_vec,
  vcov_type,
  N,
  K,
  L,
  K1,
  endo_names,
  endog_vars
)
}
\arguments{
\item{Z}{N x L instrument matrix (full model).}

\item{X}{N x K regressor matrix.}

\item{y}{N x 1 response vector.}

\item{residuals}{N x 1 residual vector from the full model (unused directly,
but included for API consistency).}

\item{rss}{Residual sum of squares from the full model (unused directly).}

\item{weights}{Normalized weights (sum to N), or NULL.}

\item{cluster_vec}{Cluster membership vector, or NULL.}

\item{vcov_type}{Character: "iid", "HC0", "HC1", or "CL".}

\item{N}{Number of observations.}

\item{K}{Number of regressors.}

\item{L}{Number of instruments.}

\item{K1}{Number of endogenous regressors.}

\item{endo_names}{Character vector of endogenous regressor names.}

\item{endog_vars}{Character vector of variables to test (subset of
\code{endo_names}), or NULL to test all.}
}
\value{
Named list with \code{stat}, \code{p}, \code{df}, \code{test_name}, \code{tested_vars},
or NULL if this is not an IV model.
}
\description{
Tests H0: specified endogenous regressors are actually exogenous.
Computes a difference-of-J (robust/cluster) or difference-of-Sargan (IID)
statistic by re-estimating a restricted model where the tested regressors
are treated as exogenous (and hence become their own instruments).
}
\details{
The same-S-matrix constraint guarantees C >= 0: the S matrix comes from
the restricted model (larger instrument set), and the full model's J
is re-estimated using the appropriate submatrix of that S.
}
\note{
The C-statistic for IID models is computed using large-sample
sigma-squared (e'e/N) for both the unrestricted and restricted models. No
small-sample correction is applied even when \code{small = TRUE}. This
matches Stata's \code{ivreg2}.
}
\keyword{internal}
