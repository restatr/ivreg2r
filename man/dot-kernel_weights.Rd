% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kernel.R
\name{.kernel_weights}
\alias{.kernel_weights}
\title{Compute kernel weights for HAC estimation}
\usage{
.kernel_weights(tau, bw, kernel)
}
\arguments{
\item{tau}{Numeric vector of lags (non-negative integers in practice).}

\item{bw}{Numeric scalar bandwidth (> 0).}

\item{kernel}{Canonical kernel name (from \code{.validate_kernel()}).}
}
\value{
Numeric vector of kernel weights, same length as \code{tau}.
}
\description{
Takes raw lag \code{tau} and bandwidth \code{bw}, normalizes internally as
\code{x = tau / bw}. Vectorized over \code{tau}.
}
\details{
Formulas match Stata's \code{m_calckw()} (livreg2.do:627â€“664) with added
singularity guards for numerical stability:
\itemize{
\item QS near zero: exponential interpolation (from sandwich::kweights)
\item Daniell at zero: limit = 1
\item Tent at zero: limit = tau^2 (and 0 when tau = 0)
\item Lag-window kernels: clipped to 0 for x > 1
}
}
\keyword{internal}
