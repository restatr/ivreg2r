% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vcov-hac.R
\name{.ac_meat}
\alias{.ac_meat}
\title{Compute AC meat matrix (autocorrelation consistent, homoskedastic)}
\usage{
.ac_meat(
  basis,
  resid,
  time_index,
  kernel,
  bw,
  N,
  dofminus,
  weights = NULL,
  weight_type = "aweight",
  ZwZ
)
}
\arguments{
\item{basis}{N x P matrix (X_hat for VCV, Z for diagnostics), sorted.}

\item{resid}{N-vector of residuals, sorted.}

\item{time_index}{List from \code{.build_time_index()}.}

\item{kernel}{Canonical kernel name.}

\item{bw}{Numeric bandwidth.}

\item{N}{Integer: number of observations.}

\item{dofminus}{Integer: large-sample DoF adjustment.}

\item{weights}{Normalized weights (sorted) or NULL.}

\item{weight_type}{Character: weight type.}

\item{ZwZ}{P x P precomputed instrument cross-product \verb{Z'WZ}.}
}
\value{
P x P matrix \code{shat / N} (normalized).
}
\description{
Returns \code{shat / N} (the per-observation AC omega). The diagonal is
\verb{sigma^2 * Z'WZ / N} where \verb{sigma^2 = e'We / (N - dofminus)}.
The VCV wrapper multiplies by N: \code{V = N * bread * (shat/N) * bread}.
Diagnostics use \code{shat/N} directly as the omega (matching the IID
convention \code{sigma^2 * ZwZ / N}).
}
\details{
The AC meat uses the Kronecker structure: \verb{sigma_tau * Z'WZ_tau} at each
lag, where \code{sigma_tau} is a scalar autocovariance of the residuals and
\verb{Z'WZ_tau} is the cross-product of instruments at lag tau.
}
\keyword{internal}
