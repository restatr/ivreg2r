% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vcov-robust.R
\name{.compute_cl_vcov}
\alias{.compute_cl_vcov}
\title{Compute cluster-robust VCV (one-way or two-way)}
\usage{
.compute_cl_vcov(
  bread,
  X_hat,
  resid,
  cluster_vec,
  N,
  K,
  M,
  small,
  dofminus = 0L,
  sdofminus = 0L
)
}
\arguments{
\item{bread}{K x K bread matrix: \eqn{(X'P_Z X)^{-1}} for IV,
\eqn{(X'X)^{-1}} for OLS.}

\item{X_hat}{N x K matrix: projected regressors for IV, original X for OLS.}

\item{resid}{Length-N residual vector.}

\item{cluster_vec}{Length-N vector (one-way) or list of 2 vectors (two-way)
of cluster identifiers.}

\item{N}{Integer: number of observations.}

\item{K}{Integer: number of regressors.}

\item{M}{Integer: number of clusters (min(M1, M2) for two-way).}

\item{small}{Logical: if \code{TRUE}, apply the finite-sample correction
\code{(N-1)/(N-K-sdofminus) * M/(M-1)}.}

\item{dofminus}{Integer: large-sample DoF adjustment (default 0).
Note: dofminus does NOT appear in cluster VCV scaling (Stata convention).}

\item{sdofminus}{Integer: small-sample DoF adjustment (default 0).}
}
\value{
K x K variance-covariance matrix.
}
\description{
Sandwich estimator with scores aggregated within clusters via
\code{\link[=.cluster_meat]{.cluster_meat()}}.  When \code{small = TRUE}, applies the Stata \code{ivreg2}
correction \code{(N-1)/(N-K-sdofminus) * M/(M-1)}.
}
\keyword{internal}
