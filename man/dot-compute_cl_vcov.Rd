% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vcov-robust.R
\name{.compute_cl_vcov}
\alias{.compute_cl_vcov}
\title{Compute one-way cluster-robust VCV}
\usage{
.compute_cl_vcov(bread, X_hat, resid, cluster_vec, N, K, M, small)
}
\arguments{
\item{bread}{K x K bread matrix: \eqn{(X'P_Z X)^{-1}} for IV,
\eqn{(X'X)^{-1}} for OLS.}

\item{X_hat}{N x K matrix: projected regressors for IV, original X for OLS.}

\item{resid}{Length-N residual vector.}

\item{cluster_vec}{Length-N vector of cluster identifiers (need not be
sequential integers).}

\item{N}{Integer: number of observations.}

\item{K}{Integer: number of regressors.}

\item{M}{Integer: number of clusters.}

\item{small}{Logical: if \code{TRUE}, apply the finite-sample correction
\code{(N-1)/(N-K) * M/(M-1)}.}
}
\value{
K x K variance-covariance matrix.
}
\description{
Sandwich estimator with scores aggregated within clusters via
\code{\link[=rowsum]{rowsum()}}.  When \code{small = TRUE}, applies the Stata \code{ivreg2} correction
\code{(N-1)/(N-K) * M/(M-1)}.
}
\keyword{internal}
