% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit-liml.R
\name{.fit_kclass}
\alias{.fit_kclass}
\title{Fit k-class estimator (LIML, Fuller, user-supplied k)}
\usage{
.fit_kclass(
  parsed,
  method = "liml",
  kclass = NULL,
  fuller = 0,
  small = FALSE,
  dofminus = 0L,
  sdofminus = 0L
)
}
\arguments{
\item{parsed}{A \code{parsed_formula} object from \code{.parse_formula()}.}

\item{method}{Character: \code{"liml"} or \code{"kclass"}.}

\item{kclass}{Numeric scalar: user-supplied k value (used only when
\code{method = "kclass"}).}

\item{fuller}{Numeric scalar: Fuller modification parameter (default 0).}

\item{small}{Logical: if \code{TRUE}, use \code{N-K} denominator for sigma.}

\item{dofminus}{Integer: large-sample DoF adjustment (default 0).}

\item{sdofminus}{Integer: small-sample DoF adjustment (default 0).}
}
\value{
A named list with \code{coefficients}, \code{residuals}, \code{fitted.values},
\code{vcov}, \code{sigma}, \code{df.residual}, \code{rank}, \code{r.squared}, \code{adj.r.squared},
\code{rss}, \code{r2u}, \code{r2c}, \code{mss}, \code{bread}, \code{X_hat}, \code{lambda}, \code{kclass_value},
\code{method}, \code{fuller_param}.
}
\description{
Computes k-class IV estimates. When \code{method = "liml"}, the LIML eigenvalue
lambda is computed from the concentration matrices. When \code{fuller > 0},
applies the Fuller (1977) bias correction \code{k = lambda - fuller / (N - L)}.
When \code{method = "kclass"}, uses the user-supplied \code{kclass} value directly.
}
\details{
The 2SLS-style bread \verb{(X_hat'WX_hat)^\{-1\}} is returned for diagnostics
and downstream HC/CL VCV computation (H2), alongside the k-class VCV
\code{sigma^2 * solve(XhXh)}.
}
\keyword{internal}
